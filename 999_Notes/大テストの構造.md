大テストは通常以下の段階があるワークフローで構成される
- テスト対象システムを取得する
- 必要なテストデータをシードとして与える
- テスト対象システムを用いて動作を実行する
- 挙動を検証する

## テスト対象システム

- 大テストの鍵はSUT
- 典型的なユニットテストは1つのクラスまたはモジュールに専念し、テストされるコードと同じプロセス内で実行される
- 大規模テストではSUTがユニットテストの場合とかなり異なり、1つ以上の別々のプロセスで、テストコードがそれ自体のプロセスに入っていることが多い
- SUTの各形式じゃ2つの主要な要因に基づいて判定可能である
	- 密閉性
		- 当該テスト以外の部品の利用と相互作用からSUTが分離されている度合い
	- 忠実性
		- SUTがテスト対象の本番環境システムを反映する正確さ
- SUTの例
	- 単一プロセスSUT
		- テスト対象システム全体が単一バイナリにパッケージ化されているし、テストコードもSUTと同じバイナリにパッケージ可能
		- シングルスレッドで実行できれば「小」テストにできるが、本番環境のトポロジーと設定への忠実性は最低になる
	- 単一マシンSUT
		- テスト対象システムが1つ以上の別々のバイナリからなり、テストはそれ自体のバイナリである。しかし全てが1つのマシン上で動作している
		- 「中」テストに用いられ、忠実性を上げるために各バイナリの本番環境起動設定を用いる
	- 複数マシンSUT
		- テスト対象システムが複数のマシン間に分散されている
		- 単一マシンSUTより忠実性が高いが、テストが「大」規模となり、ネットワークの信頼不能性とマシンの信頼不能性増加による影響を受けやすくなる
	- 共有環境（stgとprd）
		- 独立したSUTを実行せず、テストはそのまま共有環境を使う
		- 共有環境で同時に起こっている他の利用とテストが競合するかもしれず、コードが共有環境にプッシュされるのを待たなければならない
		- 本番環境の場合、エンドユーザーに影響が及ぶリスクも増大する
	- ハイブリッド
		- SUTを実行しつつ共有環境と相互作用をもたせるようにしても差し支えない場合がある

### 密閉されたSUTの利点

- 大テストでのSUTは信頼性のなさと長い所要時間双方の主要な原因となりうる
- 本番環境内テストでは本番環境にリリースしてしまっている時点で、本質的には手遅れ
- 巨大な共有ステージング環境でテストを実行する手段もあるが、スケールしていかないので最終的に競合する
	- クラウド分離またはマシン密閉SUTへの対応で競合問題を回避できる
- テスト用データであれ本番環境に含める場合は、エンドユーザーによる発見の可能性を考慮し、その発見に備えておく必要がある

### 問題の境界でSUTの規模を縮小する

- UIテストの信頼性のなさとコストの高さは悪名高い
- サードパティAPIを自動テストに使わせるのは非推奨
- データベースをメモリー内データベースで置き換え、関心のあるSUTの範囲外にあるサーバーを削除する


## テストデータ

- 大規模テストは異なる2種類のデータを必要とする
	- シードとして与えられたデータ
		- 初期設定されているデータ
	- テストトラフィック
		- テスト実行中にテスト自体によりテスト対象システムへ送信されるデータ
- データは様々な方法で生成されうる
	- 手動作成のデータ
		- 大量のデータを作成しなければならないかもしれない
	- コピーされたデータ
		- 本番環境からデータをコピーしたもの
	- 標本として抽出されたデータ
		- 提供データが多すぎて適切に扱えない時に行う
		- 最大のカバレッジを達成するために必要な最小のデータをコピーするテクニック

## 検証

- 検証を行う方法がいくつか存在する
	- 手動
		- 一貫性のあるテスト計画上で定義されている動作を実行するリグレッションテストからなるか、探索的で起こりうる新たな失敗を特定するためになるかどちらか
		- 手動リグレッションテストはシステム規模が拡大するほど手動テストにかかる人的時間をより多く必要とする
	- アサーション
		- ユニットテストに似たシステムの意図された挙動について明示的なチェック
	- A/B比較（差分）
		- 同じデータを送信した上で出力の比較が伴う
		- 人間が手動で差分を調べ、あらゆる変更が意図通りであるか確かめる
