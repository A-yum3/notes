### クラス単体で正常に動作するよう設計する

#### 良いクラスの構成要素

- インスタンス変数
- メソッドを不正状態から防御し、正常に操作するメソッド

#### 自己防衛責務

- 自分の身は自分で守らせる

### 成熟したクラスへ成長させる設計術

#### コンストラクタで確実に正常値を設定する

- コンストラクタで不正な値が入ってないかバリデーションをする
	- ガード節で守る

#### 計算ロジックをデータ保持側に寄せる

- 別のクラスに任せっきりだったことを自身にやらせるようにする

#### 不変で思わぬ動作を防ぐ

- インスタンス変数の上書きは理解しにくくなる
	- いつ変更されたのか、今の値は何なのかを気にする必要がでてくる
- 思わぬ副作用が発生する

#### 変更したい場合は新しいインスタンスを作成する

- インスタンスの中身ではなく、新しいインスタンスを生成することで不変でも成り立たせる

#### メソッド引数やローカル変数にもfinalを付け不変にする

- ローカル変数も引数も変更しないようにする

#### 「値の渡し間違い」を型で防止する

- プリミティブ型から発展させたValueObjectで渡すようにする

- **クラス設計とは、インスタンス変数を不正状態に陥らせないためのしくみづくり**
	- ロジックが一箇所に集まっている構造を**高凝集**
	- データとそのデータを操作するロジックを1つのクラスにまとめ、必要なメソッドのみを外部公開することを**カプセル化**

### プログラム構造の問題解決に役立つ設計パターン

| 設計パターン                 | 効果                                                             |
| ---------------------------- | ---------------------------------------------------------------- |
| 完全コストラクタ             | 不正状態から防護する                                             |
| 値オブジェクト               | 特定の値に関するロジックを高凝集にする                           |
| ストラテジ                   | 条件分岐を削減し、ロジックを単純化する                           |
| ポリシー                     | 条件分岐を単純化したり、カスタマイズできるようにする             |
| ファーストクラスコレクション | 値オブジェクトの亜種、コレクションに関するロジックを高凝集にする |
| スプラウトクラス             | 既存のロジックを変更せずに安全に新機能を追加する                 |

### 完全コンストラクタ

- 不正な状態から防護するための設計パターン
	- 生焼けオブジェクトの防止
	- 引数なしのデフォルトコンストラクタで生成し、あとからインスタンス変数を設定する方法を**しない**

### 値オブジェクト

- 値をクラス（型）として表現する設計パターン
- 値オブジェクトと完全コンストラクタは得たい効果が近いのでほぼセット
- 「値オブジェクト＋完全コンストラクタ」はオブジェクト指向設計の最も基本形を体現している構造のひとつ